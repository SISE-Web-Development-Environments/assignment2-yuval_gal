<html>

<head>
    <script src="js/jquery-3.4.1.slim.min.js"></script>
    <script>
        var userNameAndPassward = [{userName:"p", passward:"p"}];
        localStorage.setItem("should_begin",false);
        var currentUser;
        function clearAllLoggedUsers() {
            for (i=0; i<localStorage.length; i++)
            {
                localStorage.setItem(localStorage.key(i),false);
            }
        }


        clearAllLoggedUsers();
    </script>
    <script type="text/javascript" src="js/app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/main.css">



</head>
<body>
    <!-- Tab links -->
    <div class="nav">
        <button class="navbuttons" onclick="openRelevantWindow(event, 'Welcome')">Welcome</button>
        <button class="navbuttons" id="signupButton" onclick="openRelevantWindow(event, 'signup')">Sign Up</button>
        <button class="navbuttons" id="loginButton" onclick="openRelevantWindow(event, 'login')">Login</button>
        <button class="navbuttons" id="settingsButton" onclick="openRelevantWindow(event, 'Settings')">Settings</button>
        <button class="navbuttons" id="gameButton" onclick="openRelevantWindow(event, 'game')">Game</button>
        <button class="navbuttons" id="logoutButton" onclick="logoutUser(event)">Log out</button>
    </div>

    <!-- Tab content -->
    <div id="Welcome" class="window_content">
        <img src="logo.png">
        <br>
        <h3>Welcome to The awesome Pacman game!</h3>
        <p>This is our game, if you want to play, please signup for it.</p>
        <button type="button" id="signup-wlcm-Btn" class="block" onclick="openRelevantWindow(event, 'signup')">Sign Up !</button>
        <br>
        <button type="button" id="login-wlcm-Btn" class="block" onclick="openRelevantWindow(event, 'login')">Login !</button>
    </div>

    <div id="signup" class="window_content sign-up-form">
        <img src="images/signupiconNobackground.png" class="signup-icon">
        <h3>Sign Up Now</h3>
        <form id="signup-form">
            <input type="email" class="input-box" id="signupUsername" placeholder="Enter Username">
            <input type="password" class="input-box passClass" id="signupPass" placeholder="Your Password">
            <input type="password" class="input-box passClass" id="signupPassConfirm" placeholder="Confirm Password">
<!--            <p><span><input type="checkbox"></span> I agree to the terms of services</p>-->
            <button type="button" class="signup-btn" onclick="signUp()">Sign Up</button>
        </form>

    </div>

    <div id="login" class="window_content">
        <form id="login-form">
            <div id="loginForm">
                <h1>Login</h1>
                <i class="fa fa-user" aria-hidden="true"></i>
                <label for=userName></label> Username: </label>
                <input type="text" placeholder="Enter Username" id="userName" autocomplete="off" required>
                <br>
                <br>
                <i class="fa fa-lock" aria-hidden="true"></i>
                <label for=password>Password: </label>
                <input type="password" placeholder="Enter Password" id="password" autocomplete="off" required>
                <br>
                <br>
                <button type="button" onclick="Login()">Login</button>
            </div>
        </form>
    </div>

    <div id="Settings" class="window_content">
        <h3>Set Your Game Settings</h3>
        <p>Here Will be every settings related to the game</p>
    </div>

    <div id="game" class="window_content">
        <div id="restart">
            <button id="restartBtn">Restart</button>
        </div>

        <div id="score">
            <label for="lblScore">SCORE:</label>
            <input id="lblScore" type="text" />
        </div>

        <div id="time">
            <label for="lblTime">TIME:</label>
            <input id="lblTime" type="text" />
        </div>

        <div id="Killed">
            <label for="lblKilled">Killed:</label>
            <input id="lblKilled" type="text" />
        </div>

        <div id="user">
            <label for="userN">username:</label>
            <input id="userN" type="text" />
        </div>

        <div id="actual_game">
            <canvas id="canvas" height="600" width="600"></canvas>
        </div>
        <audio id = "backroundSound" preload = "auto">
            <source src = "audio/PacMan%20Original%20Theme.mp3" type = "audio/mpeg"></audio>
        <audio id = "hitSound" preload = "auto">
            <source src = "audio/blocker_hit.mp3" type = "audio/mpeg"></audio>
        <audio id = "eatSound" preload = "auto">
            <source src = "audio/Blop%20sound%20effect.mp3" type = "audio/mpeg"></audio>
        <audio id = "pillSound" preload = "auto">
            <source src = "audio/Extra.mp3" type = "audio/mpeg"></audio>

    </div>


<!-------------------------------------------------Scripts--------------------------------->

    <script>
        function openRelevantWindow(evt, navButton) {
            var i;
            clearWindowContent();
            clearActiveWindow();
            clearAllContents();

            document.getElementById(navButton).style.display = "block";

            if(navButton == "game" && localStorage.getItem("should_begin") == "false")
            {
                localStorage.setItem("should_begin","true");
                Start();
            }

            if(navButton == "Welcome")
            {
                showWelcomeWindow();
            }

            // evt.currentTarget.crrTrgt.className += " active";

        }
    </script>

    <script class="loginScript">
        function Login(){

            var userName = document.getElementById('userName').value;
            var passward = document.getElementById('password').value;
            currentUser = userName;
            for(i=0; i < userNameAndPassward.length; i++){
                if(userName=== userNameAndPassward[i].userName && passward === userNameAndPassward[i].passward){
                    clearButtonsForUser("false")
                    console.log("userName: "+ userName +" Passward: "+ passward+ " login successfully");
                    localStorage.setItem(userName,"true");
                    showWelcomeWindow();
                    return
                }
            }
            alert("Wrong username or password please  try again");
            console.log("Wrong username or password please try again");
        }
    </script>

    <script class="signUpScript">
        function signUp(){
            var userName = document.getElementById('signupUsername').value;
            var password = document.getElementById('signupPass').value;
            var confirmPassword = document.getElementById('signupPassConfirm').value;

            if(password !== confirmPassword)
            {
                alert("Password are not the same");
                return;
            }

            for(i=0; i < userNameAndPassward.length; i++){
                if(userName === userNameAndPassward[i].userName){
                    alert("userName: "+ userName + " is already taken");
                    return;
                }
            }

            userNameAndPassward.push({"Username": userName, "Password": password});
            console.log("User signed up successfully");

            alert("You can now login.")
            showWelcomeWindow();
            // hideSignUpForm();

        }
    </script>


    <script>
        function clearAllContents() {
            document.getElementById("Welcome").style.display = "none";
            document.getElementById("Settings").style.display = "none";
            document.getElementById("game").style.display = "none";
            document.getElementById("signup").style.display = "none";
            document.getElementById("login").style.display = "none";

        }

        function clearActiveWindow() {
            var i;
            var navButtons = document.getElementsByClassName("navbuttons");
            for (i = 0; i < navButtons.length; i++) {
                navButtons[i].className = navButtons[i].className.replace(" active", "");
            }
        }

        function clearWindowContent(){
            var i;
            var windowsContent = document.getElementsByClassName("window_content");
            for (i = 0; i < windowsContent.length; i++) {
                windowsContent[i].style.display = "none";
            }
            document.getElementById("signup-form").reset();
            document.getElementById("login-form").reset();
        }

        function showWelcomeWindow() {
            clearActiveWindow();
            clearAllContents()
            for (var i=0; i < localStorage.length; i++)
            {
                if(localStorage.getItem(localStorage.key(i)) === "true")
                {
                    document.getElementById("signup-wlcm-Btn").style.display = "none";
                    document.getElementById("login-wlcm-Btn").style.display = "none";
                }
                else
                {
                    document.getElementById("signup-wlcm-Btn").style.display = "block";
                    document.getElementById("login-wlcm-Btn").style.display = "block";
                }
            }

            pageToShow = document.getElementById("Welcome");
            pageToShow.style.display = "block";
        }

        function clearButtonsForUser(toShow){
            if(toShow === "true")
            {
                document.getElementById("gameButton").style.display = "none";;
                document.getElementById("logoutButton").style.display = "none";;
                document.getElementById("settingsButton").style.display = "none";;
                document.getElementById("loginButton").style.display = "block";
                document.getElementById("login").style.display = "block";
                document.getElementById("signupButton").style.display = "block";
            }
            if(toShow === "false")
            {
                document.getElementById("gameButton").style.display = "block";;
                document.getElementById("logoutButton").style.display = "block";;
                document.getElementById("settingsButton").style.display = "block";;
                document.getElementById("loginButton").style.display = "none";
                document.getElementById("login").style.display = "none";
                document.getElementById("signupButton").style.display = "none";
            }
        }
    </script>

    <script>
        function logoutUser() {
            for (i=0; i< localStorage.length; i++)
            {
                if(localStorage.getItem(localStorage.key(i)) === "true")
                {
                    //user is not logged in anymore
                    localStorage.setItem(localStorage.key(i), "false");
                    localStorage.setItem("should_begin", "false");
                    clearButtonsForUser("true");

                    showWelcomeWindow();
                }
            }

        }
    </script>

</body>

</html>