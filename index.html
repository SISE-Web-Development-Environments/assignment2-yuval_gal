<html>

<head>
    <script src="js/jquery-3.4.1.slim.min.js"></script>
    <script>
        var userNameAndPassward = [{userName:"p", passward:"p"}];
        localStorage.setItem("should_begin",false);
        var currentUser;
        function clearAllLoggedUsers() {
            for (i=0; i<localStorage.length; i++)
            {
                localStorage.setItem(localStorage.key(i),false);
            }
        }


        clearAllLoggedUsers();
    </script>
    <script type="text/javascript" src="js/app.js"></script>
<!--    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">-->
    <script src="https://code.jquery.com/jquery-2.2.4.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.1.3.min.js"></script>
    <script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.13.0/jquery.validate.min.js"></script>
    <script src="js/form-validation.js"></script>
    <link rel="stylesheet" href="css/main.css">



</head>
<body>
<div class="header">
    <img class=resize src="images/logopacman.png">
</div>

    <!-- Tab links -->
    <div class="nav">
        <button class="navbuttons" onclick="openRelevantWindow(event, 'Welcome')">Welcome</button>
        <button class="navbuttons" id="signupButton" onclick="openRelevantWindow(event, 'signup')">Sign Up</button>
        <button class="navbuttons" id="loginButton" onclick="openRelevantWindow(event, 'login')">Login</button>
        <button class="navbuttons" id="settingsButton" onclick="openRelevantWindow(event, 'Settings')">Settings</button>
        <button class="navbuttons" id="gameButton" onclick="openRelevantWindow(event, 'game')">Game</button>
        <button class="navbuttons" id="aboutButton">
            <a id="about" href="#popUpModal" rel="modal:open">About</a>
        </button>
        <button class="navbuttons" id="logoutButton" onclick="logoutUser(event)">Log out</button>
    </div>
    <!-- Link to open the modal -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>
    <!-- jQuery Modal -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

    <!-- Tab content -->
    <div id="Welcome" class="window_content">
        <img src="images/logo.png">
        <br>
        <h3>Welcome to The awesome Pacman game!</h3>
        <p>This is our game, if you want to play, please signup for it.</p>
        <button type="button" id="signup-wlcm-Btn" class="block" onclick="openRelevantWindow(event, 'signup')">Sign Up !</button>
        <br>
        <button type="button" id="login-wlcm-Btn" class="block" onclick="openRelevantWindow(event, 'login')">Login !</button>
    </div>

    <div id="signup" class="window_content sign-up-form">
        <img src="images/signupiconNobackground.png" class="signup-icon">
        <br>
        <h3>Sign Up Now</h3>
        <div class="container well" style="margin-top: 50px">
            <form id="register-form">
                <div class="form-group-col-md-6">
                    <input class="form-control" name="userName" id="signupUsername" placeholder="userName" type="text">
                </div>
                <div class="form-group col-md-12">
                    <input class="form-control" name="email" id="email" placeholder="Email address" type="email">
                </div>
                <div class="form-group col-md-6">
                    <input class="form-control passClass" name="password" id="signup-password" placeholder="Password" type="password">
                </div>
<!--                <div class="form-group col-md-6">-->
<!--                    <input class="form-control passClass" name="signup-password2" placeholder="Re-enter password" type="password">-->
<!--                </div>-->
                <div class="clearfix">
                </div>

                <div class="form-group col-md-6">
                    <input class="form-control" name="firstName" id="firstName" placeholder="First Name" type="text">
                </div>
                <div class="form-group col-md-6">
                    <input class="form-control" name="secondName" id="secondName" placeholder="Second Name" type="text">
                </div>

                <div class="form-group col-md-12">
                    <input class="form-control" name="bDay" id="bDay" placeholder="BDay" type="date" required>
                </div>
                <div>
                    <input class="btn btn-primary" id="submit-button" type="submit" onclick="signUp()" value="Sign Up">
                </div>

            </form>
        </div>
        <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.1.3.min.js"></script>
        <script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.13.0/jquery.validate.min.js"></script>
        <script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.13.0/additional-methods.min.js"></script>
        <script src="js/validation.js"></script>

    </div>

    <div id="login" class="window_content sign-up-form">
        <img src="images/signupiconNobackground.png" class="signup-icon">
        <br>
        <div class="container well" style="margin-top: 50px">
        <form id="login-form">
            <div id="loginForm">
                <h1>Login</h1>
                <div class="form-group col-md-6">
                <i class="fa fa-user" aria-hidden="true"></i>
                <label for=userName> Username: </label>
                <input class="form-control" type="text" placeholder="Enter Username" id="userName" autocomplete="off" required>
                </div>
                <div class="form-group col-md-6">
                <i class="fa fa-lock" aria-hidden="true"></i>
                <label for=password>Password: </label>
                <input class="form-control" type="password" placeholder="Enter Password" id="password" autocomplete="off" required>
                </div>
                <button class="btn btn-primary" type="button" onclick="Login()">Login</button>
            </div>
        </form>
        </div>
    </div>

    <div id="popUpModal" class="modal">
        <h3>About Us</h3>
        <p> bla bla bla</p>
        <a href="#" rel="modal:close">Close</a>
    </div>

    <div id="GameAndSettings">
        <div id="Settings" class="window_content">
            <h1>Set Your Game Settings</h1>
            <div class="main">
                <form>
                    <table style="width:30%;">
                        <tr>
                            <th> KeySelection </th>
                            <th> Time Settings </th>
                            <th> Balls Settings </th>
                            <th> General Settings </th>
                        </tr>
                        <tr>
                            <td>Up:  <input class="choseable_keys" id="keyUp" onclick="keyPressedSelector(this.id)" type="button" value="ArrowUp" name="38"></td>
                            <td>Select Max Time for the game: <input id="maxTimeForGame" type="number" min="60" value="60" ></td>
                            <td>Select number of eatable balls:  <select id="numOfBalls" name="numOfBalls">
                                <option value="50">50</option>
                                <option value="51">51</option>
                                <option value="52">52</option>
                                <option value="53">53</option>
                                <option value="54">54</option>
                                <option value="55">55</option>
                                <option value="56">56</option>
                                <option value="57">57</option>
                                <option value="58">58</option>
                                <option value="59">59</option>
                                <option value="60">60</option>
                                <option value="61">61</option>
                                <option value="62">62</option>
                                <option value="63">63</option>
                                <option value="64">64</option>
                                <option value="65">65</option>
                                <option value="66">66</option>
                                <option value="67">67</option>
                                <option value="68">68</option>
                                <option value="69">69</option>
                                <option value="70">70</option>
                                <option value="71">71</option>
                                <option value="72">72</option>
                                <option value="73">73</option>
                                <option value="74">74</option>
                                <option value="75">75</option>
                                <option value="76">76</option>
                                <option value="77">77</option>
                                <option value="78">78</option>
                                <option value="79">79</option>
                                <option value="80">80</option>
                                <option value="81">81</option>
                                <option value="82">82</option>
                                <option value="83">83</option>
                                <option value="84">84</option>
                                <option value="85">85</option>
                                <option value="86">86</option>
                                <option value="87">87</option>
                                <option value="88">88</option>
                                <option value="89">89</option>
                                <option value="90">90</option>

                            </select>
                            </td>
                            <td>Select the number of ghosts:   <select id="numOfGhosts" name="numOfGhosts">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                            </select>
                            </td>
                        </tr>
                        <tr>

                            <td>Down:  <input class="choseable_keys" id="keyDown" onclick="keyPressedSelector(this.id)" type="button" value="ArrowDown" name="40"></td>
                            <td></td>
                            <td>Select Color for the light balls:    <input id="lightBallColor" type="color" value="#0000ff"></td>
                        </tr>
                        <tr>
                            <td>Left:  <input class="choseable_keys" id="keyLeft" onclick="keyPressedSelector(this.id)" type="button" value="ArrowLeft" name="37"></td>
                            <td></td>
                            <td>Select Color for the medium balls:    <input id="medBallColor" type="color" value="#ff0000"></td>
                        </tr>
                        <tr>
                            <td>Right:  <input class="choseable_keys" id="keyRight" onclick="keyPressedSelector(this.id)" type="button" value="ArrowRight" name="39" ></td>
                            <td></td>
                            <td>Select Color for the hevy balls:    <input id="heavyBallColor" type="color" value="#000000"></td>
                        </tr>
                    </table>
                    <div style="margin-top: 3%;">
                        <input  type="button" id="settingsRndmButton" value="randomize all values" onclick="randomizeSettings()">
                        <input style="margin-left: 10%;" type="button" id="settingStartGameButton" onclick="beginGame()" value="Let's Start the Game!">
                    </div>
                </form>
            </div>
        </div>

        <div id="game" class="window_content">
<!--            <div id="restart">-->
<!--                <button id="restartBtn">Restart</button>-->
<!--            </div>-->
            <div id="gameValues">
                <div id="in-game-score" class="in-game">
                    <label for="lblScore">SCORE:</label>
                    <input id="lblScore" type="text" />
<!--                </div>-->

<!--                <div id="in-game-time" class="in-game">-->
                    <label for="lblTime">TIME:</label>
                    <input id="lblTime" type="text" />
<!--                </div>-->
                    <br>
<!--                <div id="in-game-Killed" class="in-game">-->
                    <label for="lblLives">Lives:</label>
                    <input id="lblLives" type="text" />
<!--                </div>-->

<!--                <div id="in-game-user" class="in-game">-->
                    <label for="userN">username:</label>
                    <input id="userN" type="text" />
                </div>
            </div>
            <div id="actual_game">
                <canvas id="canvas" height="720" width="720" tabindex="1"></canvas>
            </div>
            <audio id = "backroundSound" preload = "auto">
                <source src = "audio/PacMan%20Original%20Theme.mp3" type = "audio/mpeg"></audio>
            <audio id = "hitSound" preload = "auto">
                <source src = "audio/blocker_hit.mp3" type = "audio/mpeg"></audio>
            <audio id = "eatSound" preload = "auto">
                <source src = "audio/Blop%20sound%20effect.mp3" type = "audio/mpeg"></audio>
            <audio id = "pillSound" preload = "auto">
                <source src = "audio/Extra.mp3" type = "audio/mpeg"></audio>
            <audio id = "eatGhost" preload = "auto">
                <source src = "audio/blocker_hit.mp3" type = "audio/mpeg"></audio>

        </div>
    </div>



<!-------------------------------------------------Scripts--------------------------------->

    <script type="text/javascript">
        function keyPressedSelector(keyId) {
            console.log(keyId);
            var keyPressed = $("#" + keyId);
            keyPressed.keydown(function (event) {
                keyPressed.prop("name",event.keyCode);
                keyPressed.prop("value",event.key);
                keyPressed.off("keydown");
            });

        }
    </script>

    <script type="text/javascript">

        function validateSettings() {
            var valueOfKeyUp = document.getElementById("keyUp").name;
            var valueOfKeyDown = document.getElementById("keyDown").name;
            var valueOfKeyLeft = document.getElementById("keyLeft").name;
            var valueOfKeyRight = document.getElementById("keyRight").name;

            var colorLight = document.getElementById("lightBallColor").value;
            var colorMed = document.getElementById("medBallColor").value;
            var colorHev = document.getElementById("heavyBallColor").value;

            if(valueOfKeyUp === valueOfKeyDown || valueOfKeyUp === valueOfKeyLeft || valueOfKeyUp === valueOfKeyRight
                || valueOfKeyDown === valueOfKeyLeft || valueOfKeyDown === valueOfKeyRight || valueOfKeyLeft === valueOfKeyRight
                || colorLight === colorMed || colorLight === colorHev || colorMed === colorHev)
            {
                return false;
            }

            return true;
        }

        function getSettingsValue() {
            var maxTime = document.getElementById("maxTimeForGame").value;
            var valueOfKeyUp = document.getElementById("keyUp").name;
            var valueOfKeyDown = document.getElementById("keyDown").name;
            var valueOfKeyLeft = document.getElementById("keyLeft").name;
            var valueOfKeyRight = document.getElementById("keyRight").name;

            var colorLight = document.getElementById("lightBallColor").value;
            var colorMed = document.getElementById("medBallColor").value;
            var colorHev = document.getElementById("heavyBallColor").value;

            var numOfEatableBalls = document.getElementById("numOfBalls").value;
            var numOfGhosts = document.getElementById("numOfGhosts").value;


            return [maxTime, numOfEatableBalls, numOfGhosts, colorLight,colorMed,colorHev,valueOfKeyUp,valueOfKeyDown,valueOfKeyLeft,valueOfKeyRight];
        }

        function beginGame() {
            if(validateSettings())
            {
                var settingsValues = getSettingsValue();
                localStorage.setItem("should_begin","true");
                document.getElementById("game").style.display = "block";
                setSettingVars(settingsValues[0],settingsValues[1],settingsValues[2],settingsValues[3],settingsValues[4],settingsValues[5],settingsValues[6],
                    settingsValues[7],settingsValues[8],settingsValues[9],settingsValues[10]);

                return;
            }
            alert("Keys and Colors could not be Equals");
        }

    </script>


    <script type="text/javascript">
        function randomizeSettings() {
            //Generate Random Max Time
            var randomTime = Math.floor(Math.random()*3600)+60;
            document.getElementById("maxTimeForGame").value = randomTime;

            //Generate Random of eatable balls
            var randomEatBalls = Math.floor(Math.random()*41)+50;
            document.getElementById("numOfBalls").value = randomEatBalls;

            //Generate Random of Ghosts
            var randomGhosts = Math.floor(Math.random()*2)+1;
            document.getElementById("numOfGhosts").value = randomGhosts;

            //Generate Random of Colors - Light
            var randomLightColor = getRandomColor();
            document.getElementById("lightBallColor").value = randomLightColor;

            //Generate Random of Colors - Medium
            var randomMedColor = getRandomColor();
            document.getElementById("medBallColor").value = randomMedColor;

            //Generate Random of Colors - Heavy
            var randomHeavyColor = getRandomColor();
            document.getElementById("heavyBallColor").value = randomHeavyColor;

        }

        function getRandomColor() {
            var letters = '0123456789ABCDEF';
            var color = '#';
            for (var i = 0; i < 6; i++) {
                color += letters[Math.floor(Math.random() * 16)];
            }
            return color;
        }


    </script>

    <script>
        function openRelevantWindow(evt, navButton) {
            var i;
            clearWindowContent();
            clearActiveWindow();
            clearAllContents();
            document.getElementById(navButton).style.display = "block";

            if(navButton == "game" && localStorage.getItem("should_begin") == "false")
            {
                localStorage.setItem("should_begin","true");
            }

            if(navButton == "Welcome")
            {
                gameOver();
                showWelcomeWindow(evt);
            }

            if(navButton == "Settings")
            {
                gameOver();
                showSettingsWindow(evt);
            }

            // evt.currentTarget.crrTrgt.className += " active";

        }
    </script>

    <script class="loginScript">
        function Login(){
            var userName = document.getElementById('userName').value;
            var passward = document.getElementById('password').value;
            if(userName === "" || passward === ""){
                alert("Enter a password and username");
                return;
            }
            currentUser = userName;
            for(i=0; i < userNameAndPassward.length; i++){
                if(userName=== userNameAndPassward[i].userName && passward === userNameAndPassward[i].passward){
                    clearButtonsForUser("false")
                    console.log("userName: "+ userName +" Passward: "+ passward+ " login successfully");
                    localStorage.setItem(userName,"true");
                    showSettingsWindow(event);
                    return;
                }
            }
            alert("Wrong username or password please  try again");
            console.log("Wrong username or password please try again");
        }
    </script>

    <script class="signUpScript">
        function signUp(){
            var userName = document.getElementById("signupUsername").value;
            var password = document.getElementById("signup-password").value;
            var firstName = document.getElementById("firstName").value;
            var secondName = document.getElementById("secondName").value;
            var email = document.getElementById("email").value;
            var bDay = document.getElementById("bDay").value;

            if(userName === "" || password === "" || firstName === "" || secondName === "" || email === "" || bDay === "" ){
                return;
            }
            for(i=0; i < userNameAndPassward.length; i++){
                if(userName === userNameAndPassward[i].userName){
                    alert("userName: "+ userName + " is already taken");
                    return;
                }
            }

            userNameAndPassward.push({"userName": userName, "passward": password});
            console.log("User signed up successfully");

            alert("You can now login.")
            showWelcomeWindow(event);
            // hideSignUpForm();

        }
    </script>


    <script>
        function clearAllContents() {
            document.getElementById("Welcome").style.display = "none";
            document.getElementById("Settings").style.display = "none";
            document.getElementById("game").style.display = "none";
            document.getElementById("signup").style.display = "none";
            document.getElementById("login").style.display = "none";
        }

        function clearActiveWindow() {
            var i;
            var navButtons = document.getElementsByClassName("navbuttons");
            for (i = 0; i < navButtons.length; i++) {
                navButtons[i].className = navButtons[i].className.replace(" active", "");
            }
        }

        function clearWindowContent(){
            var i;
            var windowsContent = document.getElementsByClassName("window_content");
            for (i = 0; i < windowsContent.length; i++) {
                windowsContent[i].style.display = "none";
            }
            document.getElementById("register-form").reset();
            document.getElementById("login-form").reset();
        }

        function showSettingsWindow(evt) {
            clearActiveWindow();
            clearAllContents();
            pageToShow = document.getElementById("Settings");
            pageToShow.style.display = "block";
            evt.currentTarget.className += " active";
        }

        function showWelcomeWindow(evt) {
            clearActiveWindow();
            clearAllContents();
            for (var i=0; i < localStorage.length; i++)
            {
                if(localStorage.getItem(localStorage.key(i)) === "true")
                {
                    document.getElementById("signup-wlcm-Btn").style.display = "none";
                    document.getElementById("login-wlcm-Btn").style.display = "none";
                }
                else
                {
                    document.getElementById("signup-wlcm-Btn").style.display = "block";
                    document.getElementById("login-wlcm-Btn").style.display = "block";
                }
            }

            pageToShow = document.getElementById("Welcome");
            pageToShow.style.display = "block";
            evt.currentTarget.className += " active";
        }

        function clearButtonsForUser(toShow){
            if(toShow === "true")
            {
                document.getElementById("gameButton").style.display = "none";;
                document.getElementById("logoutButton").style.display = "none";;
                document.getElementById("settingsButton").style.display = "none";;
                document.getElementById("loginButton").style.display = "block";
                document.getElementById("login").style.display = "block";
                document.getElementById("signupButton").style.display = "block";
            }
            if(toShow === "false")
            {
                document.getElementById("gameButton").style.display = "block";;
                document.getElementById("logoutButton").style.display = "block";;
                document.getElementById("settingsButton").style.display = "block";;
                document.getElementById("loginButton").style.display = "none";
                document.getElementById("login").style.display = "none";
                document.getElementById("signupButton").style.display = "none";
            }
        }
    </script>

    <script>
        function logoutUser() {
            for (i=0; i< localStorage.length; i++)
            {
                if(localStorage.getItem(localStorage.key(i)) === "true")
                {
                    //user is not logged in anymore
                    localStorage.setItem(localStorage.key(i), "false");
                    localStorage.setItem("should_begin", "false");
                    clearButtonsForUser("true");

                    showWelcomeWindow(event);
                }
            }

        }
    </script>

<!--Footer-->
    <footer>
        <h3> This game was created by Gal & Yuval </h3>
        Contact information: <a href="mailto:ybene@post.bgu.ac.il">ybene@post.bgu.ac.il</a>.
        <a href="mailto:rosengal@post.bgu.ac.il">rosengal@post.bgu.ac.il</a>.
    </footer>
</body>

</html>